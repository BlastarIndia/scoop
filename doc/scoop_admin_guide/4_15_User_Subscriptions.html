<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.70)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>4.15 User Subscriptions</TITLE>
<META NAME="description" CONTENT="4.15 User Subscriptions">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="sag.css">

<LINK REL="next" HREF="4_16_User_submitted_Adverti.html">
<LINK REL="previous" HREF="4_14_Per_user_File.html">
<LINK REL="up" HREF="4_Scoop_Features.html">
<LINK REL="next" HREF="4_16_User_submitted_Adverti.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><A href="http://scoop.kuro5hin.org/"><IMG src="small_logo.jpg"></A><UL><LI><A href="sag.html">SAG Home</A></LI>
<LI><A href="1_Introduction.html"><SPAN CLASS="arabic">1</SPAN> Introduction</A></LI>
<LI><A href="2_Installation.html"><SPAN CLASS="arabic">2</SPAN> Installation</A></LI>
<LI><A href="3_Setup_Administration.html"><SPAN CLASS="arabic">3</SPAN> Setup and Administration</A></LI>
<LI><A href="4_Scoop_Features.html"><SPAN CLASS="arabic">4</SPAN> Scoop Features and Customization</A></LI>
<UL>
<LI><A href="4_1_Story_Selection.html"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">1</SPAN> Story Selection</A></LI>
<LI><A href="4_2_User_Diaries.html"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">2</SPAN> User Diaries</A></LI>
<LI><A href="4_3_Story_Archiving.html"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">3</SPAN> Story Archiving</A></LI>
<LI><A href="4_4_Story_Digest.html"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">4</SPAN> Story Digest Emails</A></LI>
<LI><A href="4_5_Story_Syndication.html"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">5</SPAN> Story Syndication (RDF)</A></LI>
<LI><A href="4_6_Story_hotlisting_bookma.html"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">6</SPAN> Story hotlisting/bookmarking</A></LI>
<LI><A href="4_7_Automatic_Related.html"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">7</SPAN> Automatic `Related Links' listing</A></LI>
<LI><A href="4_8_Comments_Comment.html"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">8</SPAN> Comments and Comment Views</A></LI>
<LI><A href="4_9_Polls.html"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">9</SPAN> Polls</A></LI>
<LI><A href="4_10_Spell_checking_Stories.html"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">10</SPAN> Spell-checking Stories and Comments</A></LI>
<LI><A href="4_11_Macros_in.html"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">11</SPAN> Macros in Stories and Comments</A></LI>
<LI><A href="4_12_Spam_Crapflood.html"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">12</SPAN> Spam and Crapflood Prevention</A></LI>
<LI><A href="4_13_Trusted_Users.html"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">13</SPAN> Trusted Users and Mojo</A></LI>
<LI><A href="4_14_Per_user_File.html"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">14</SPAN> Per-user File Uploads</A></LI>
<LI><A href="4_15_User_Subscriptions.html" id="current"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">15</SPAN> User Subscriptions</A></LI>
<LI><A href="4_16_User_submitted_Adverti.html"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">16</SPAN> User-submitted Advertisements</A></LI>
<LI><A href="4_17_Calendar.html"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">17</SPAN> Calendar</A></LI>
<LI><A href="4_18_Site_Layout.html"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">18</SPAN> Site Layout and Themes</A></LI>
<LI><A href="4_19_Flexible_Sections.html"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">19</SPAN> Flexible Sections and Categorization</A></LI>
<LI><A href="4_20_Searching_Relevance.html"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">20</SPAN> Searching by Relevance</A></LI>
<LI><A href="4_21_Page_Caching.html"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">21</SPAN> Page Caching</A></LI>
<LI><A href="4_22_Payment_Processing.html"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">22</SPAN> Payment Processing</A></LI>
<LI><A href="4_23_Admin_Action.html"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">23</SPAN> Admin Action Logging</A></LI>
<LI><A href="4_24_Access_Control.html"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">24</SPAN> Access Control While Upgrading</A></LI>
<LI><A href="4_25_Boxtool.html"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">25</SPAN> Boxtool</A></LI>
</UL>
<LI><A href="5_Extending_Scoop_s.html"><SPAN CLASS="arabic">5</SPAN> Extending Scoop's Abilities</A></LI>
<LI><A href="A_Admin_Tools.html">A. The Admin Tools Menu</A></LI>
<LI><A href="B_Scoop_Box.html">B. The Scoop Box Exchange</A></LI>
<LI><A href="C_Frequently_Asked.html">C. Frequently Asked Questions</A></LI>
<LI><A href="About_this_document.html">About this document ...</A></LI>
</UL>
</DIV>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><A NAME="tex2html604"
  HREF="4_15_User_Subscriptions.html#SECTION000415100000000000000"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">15</SPAN>.<SPAN CLASS="arabic">1</SPAN> Setting up Subscriptions</A>
<LI><A NAME="tex2html605"
  HREF="4_15_User_Subscriptions.html#SECTION000415200000000000000"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">15</SPAN>.<SPAN CLASS="arabic">2</SPAN> Giving Special Privileges</A>
<LI><A NAME="tex2html606"
  HREF="4_15_User_Subscriptions.html#SECTION000415300000000000000"><SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">15</SPAN>.<SPAN CLASS="arabic">3</SPAN> Some Security Considerations</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H2><A NAME="SECTION000415000000000000000"></A>
<A NAME="features-subscriptions"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">15</SPAN> User Subscriptions
</H2>

<P>
Subscribers can be given extra features, such as the ability to turn ads off, or permission to read private sections, or even just a token such as an icon next to their name on comments.  You can also give permission to use an ``expensive'' (that is, computationally expensive and generally slow) Scoop box in their sidebar, such as the ``Who's online?'' box, available on the Scoop Box Exchange.

<P>
You will almost certainly want to have payment processing (<A HREF="4_22_Payment_Processing.html#features-cc-paypal">4.22</A>) set up to handle payment for those subscriptions.

<P>

<H3><A NAME="SECTION000415100000000000000">
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">15</SPAN>.<SPAN CLASS="arabic">1</SPAN> Setting up Subscriptions</A>
</H3>

<P>
The first step in setting up subscriptions is to <B>create a new user group for the subscribers</B> and giving it the appropriate permissions.  Basing it on the Users group then adding permissions is probably a good idea, as nobody will be pleased about losing permissions due to subscribing.

<P>
If you will have several levels of subscriptions, you will need to create <B>one user group per subscription level</B>, with the appropriate permissions for each.  It's probably a good idea to make each subscription level include the permissions for all levels below, but nothing requires it.  Again, nobody will be pleased about losing permissions due to upgrading a subscription.

<P>
The second step is to <B>create the subscription type</B>, using the Subscriptions Admin Tool (<A HREF="A_17_Subscriptions.html#admin-tools-subscriptions">A.17</A>).  You can specify the price per month, the user group (which you created in step 1) a subscriber is moved to, and so on.  Save the subscription type once all the boxes are filled in the way you want.

<P>
Third, the users <B>must have permission</B> to subscribe; this is set using the <B>allow_subscription</B> perm.  This may not be all groups, especially if you have a restricted group for abusive users.  See <A HREF="#subscription-security">4.15.3</A> for such considerations.

<P>
If you want Scoop to move people to the subscriber group(s) automatically (this only makes sense if you have payment processing (<A HREF="4_22_Payment_Processing.html#features-cc-paypal">4.22</A>) set up), you should give the permission <B>sub_allow_group_change</B> to the groups for which you want to allow automated subscriptions.  Groups which do not have this permission trigger an email to the site administrator requesting a manual group change to the subscriber group.

<P>
Finally, you can activate the subscription system by turning the variable <B>use_subscriptions</B> on in the Site Controls Admin Tool (<A HREF="A_6_Site_Controls.html#admin-tools-vars">A.6</A>).

<P>

<H3><A NAME="SECTION000415200000000000000">
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">15</SPAN>.<SPAN CLASS="arabic">2</SPAN> Giving Special Privileges</A>
</H3>

<P>
You can give subscribers special permissions (such as the use of the spellchecker) which the regular users don't have simply by selecting the appropriate perms in the Groups Admin Tool (<A HREF="A_12_Groups.html#admin-tools-groups">A.12</A>).

<P>
You can also give them access to certain boxes, allowing you to effectively give subscribers access to any feature Scoop could ever have added through the box system.  (See sections&nbsp;<A HREF="B_Scoop_Box.html#sbe">B</A> and&nbsp;<A HREF="5_Extending_Scoop_s.html#hacking">5</A> for details on adding features using boxes.)

<P>
If you want to give access to a sidebar box, such as the database-intensive ``Who's Online?'' box, only to subscribers, you first create a perm for that box.  Add the perm to the variable <B>perms</B> in the Site Controls Admin Tool, in the Security category.  Then, in the Groups Admin Tool, load the desired subscriber group, select the new perm, and save.  The subscriber group now has permission to do whatever that perm allows.

<P>
The perm must then be checked in the relevant box, or it's rather pointless.  In the Boxes Admin Tool, load the box with the feature you are giving to subscribers.  At the beginning of the box, add the line:

<P>
<PRE>
return '' unless( $S-&gt;have_perm("new_perm_name") );
</PRE>

<P>
and replace new_perm_name with the name of the perm you just created.

<P>
This will cause the box to exit immediately (returning an empty string as its final output) unless the user is in a group with the permission named.  Boxes that produce no output disappear without a trace, and a user will never know that it is there until they subscribe.

<P>
Once the box has been created and tested, place it on the page template where appropriate (such as in the sidebar in the block index_template).  Subscribers will then see the box where you placed it; non-subscribers will not be aware of its presence or absence.

<P>
You can create a general permission that says that the user is a subscriber, but if you want to have levels of subscriptions, or if you may someday change which box features are avail to which subscriber group, having an appropriately named perm for each would be easier to manage, as you can just check and uncheck the permissions for the different groups, instead of having to edit the boxes.

<P>

<H3><A NAME="SECTION000415300000000000000"></A>
<A NAME="subscription-security"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN>.<SPAN CLASS="arabic">15</SPAN>.<SPAN CLASS="arabic">3</SPAN> Some Security Considerations
</H3>

<P>
When giving out extra permissions to subscribers, pay close attention to the descriptions in the Groups Admin Tool documentation (<A HREF="A_12_Groups.html#admin-tools-groups">A.12</A>) as some permissions should only be given to trusted users, not just anybody who pays for a subscription.

<P>
<B>If you have a restricted group</B>, such as a ratings-prohibited or commenting-prohibited group, created for rating or commenting abuse, they should not have the perm <B>allow_subscription</B> or they will be able to leave their restricted group simply by purchasing the minimum subscription.

<P>

<HR>
<ADDRESS>
<I>janra <BR>
2005-02-27</I>
</ADDRESS>
</BODY>
</HTML>
